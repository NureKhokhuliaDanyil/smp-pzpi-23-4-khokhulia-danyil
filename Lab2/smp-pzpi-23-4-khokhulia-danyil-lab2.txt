Харківський національний університет радіоелектроніки
Факультет комп’ютерних наук
Катедра програмної інженерії

ЗВІТ
З лабораторної роботи №2
з дисципліни «Скриптові мови програмування»
на тему: «Програмування у скриптовій мові shell (bash)»

Виконав                                                                                                     
ст. гр. ПЗПІ-23-4                                                
Хохуля Даниіл                                           

Перевірив
ст. викладач кафедри ПІ
Сокорчук Ігор Петрович

Харків 2025

ПРИНЦИПИ РОБОТИ PHP. ОСНОВНІ СИНТАКСИЧНІ КОНСТРУКЦІЇ. ДАНІ, ЇХ ТИПИ ТА РОБОТА З НИМИ

1 ІСТОРІЯ ЗМІН

№	Дата		Версія звіту	Опис змін та виправлень
1     18.05.2025	    0.1	        Створено розділи «Історія змін», «Завдання», «Опис виконаної роботи», «Висновки», «Додаток А», «Додаток В»

2 ЗАВДАННЯ
2.1 Мета роботи
Ознайомитися з основами синтаксису та принципами роботи мови РНР. Отримати практичні навички написання програм скриптовими мовами
2.2 Завдання 
Потрібно створити консольний застосунок «Продовольчий магазин "Весна"».
Ім’я користувача не може бути порожнім і повинно містити хоча б одну літеру.
Користувач не може бути молодшим 7-ми або старшим 150-ти років
Щоб завершити роботу та вийти з програми, потрібно ввести число «0».
У програмі потрібно перевіряти інформацію, яку вводить користувач, а саме:
* обраний пункт меню існує;
* обраний товар існує;
* введена кількість товару більша нуля;
* ім’я користувача містить хча б одну літеру;
* вік користувача становить від 7-ми до 150-ти років.
Робота та функціональність створеної програми повинна збігатися із тестовою програмою:

3 ОПИС ВИКОНАНОЇ РОБОТИ
Скрипт призначено для автоматичного перетворення CSV-файлу з розкладом занять (у кодуванні Windows-1251) у формат, придатний для імпорту в Google Календар. 
Перш за все в скрипті оголошено усі глобальні зміні які знадобляться для коректної роботи програми. А саме VER, QUIET, GRP, CSV_FILE. 
Після цього за допомогою while циклу реалізуємо роботу ключей згідно з умовою завдання ( --help, --version, -q, --quiet ). За допомогою циклу ми змогли почергово обробити кожен з ключей та реалізувати логіку його роботи. (див. Додаток Б.1)
У наступному блоці коду реалізовано вибір файлу з розкладом з cist зі списку, якщо його не було вказано як параметр запуску застосунка. Цей файл має відповідати шаблону TimeTable_??_??_20??.csv . В цьому блоці коду було використано команду select  для реалізації списку з вибором. (див. Додаток Б.2)
Далі я реалізував функціонал вибору академічної групи, якщо її також не було вказано як параметр запуску. Для цього ми беремо усі згадані в файлі з розкладом групи та пропонуємо користувачу обрати одну з них. У цьому блоці коду я використав команди awk, iconv, sort та uniq, sed. (див. Додаток Б.3)
Після чого ми використовуємо фільтрацію на основі вибраної академічної групи. Ми витягуємо усі рядки які відповідають обраній академічній групі та додає форматування. Отримані дані сортуються за допомогою унікального ключа, побудованого на основі дати та часу, щоб забезпечити правильний порядок подій. (див. Додаток Б.4)
Переходимо до найважливішого блоку коду, безпосередньо формування csv файлу для імпорту в Google календар. Отриманні наші результати з минулого блоку ми переводимо до формату дати MM/DD/YYYY, час встановлюємо у форматі 12 годин AM/PM, та додаємо порядкові номера до занять. В якості інформації яку ми беремо з розкладу це Предмет, час початку та кінця, дата старту та кінця, та опис предмету. Після чого отриманні дані ми записуємо до csv та робимо вивід у консоль якщо немає тихого режиму роботи. (див. Додаток Б.5)
В кінці роботи програми додано блок коду який видаляє тимчасові файли, які були створені під час роботи програми. (див. Додаток Б.6)
	
4 ВИСНОВКИ
У результаті виконання даної лабораторної роботи я ознайомився з основами синтаксису та принципами роботи мови PHP. Отримав практичні навички написання програм скриптовими мовами. 

ДОДАТОК А
Відеозапис
Відеозапис результатів виконання лабораторної роботи: https://youtu.be/kZQc7ZyidV4
Хронологічний опис відеозапису: 
00:00 - Оголошення зміних для роботи скрипта 
00:39 - Отримання максимальної довжини елементу масива ( функція Get_length) 
1:18 - Вивід стану корзини до консолі
2:45 - Придбання обраного з меню продукту
4:02 - Вибір товару з меню магазину
5:08 - Отримання та вивід остаточного рахунку користувача 
7:15 - Редагування профіля користувача
8:05 - Запуск головного меню магазину

ДОДАТОК Б
Програмний код застосунку
Github репозиторій в якому розміщено код: https://github.com/NureKhokhuliaDanyil/smp-pzpi-23-4-khokhulia-danyil/blob/main/Lab2/smp-pzpi-23-4-khokhulia-danyil-lab2/smp-pzpi-23-4-khokhulia-danyil-lab2-code
Б.1 Оголошення зміних середовища
  1 <?php
  2
  3 $prices = ['Молоко пастеризоване' => 12,
  4           'Хліб чорний' => 9,
  5           'Сир білий' => 21,
  6           'Сметана 20%' => 25,
  7           'Кефір 1%' => 19,
  8           'Вода газована' => 18,
  9           'Печиво "Весна"' => 14];
 10
 11 $products = ['Молоко пастеризоване', 'Хліб чорний', 'Сир білий',
 12 'Сметана 20%', 'Кефір 1%', 'Вода газована', 'Печиво "Весна"'];
 13
 14 $basket = [];
 15
Б.2 Допоміжна функція для отримання максимальної довжини масива
 16 function Get_length($array)
 17 {
 18     $max_l = 0;
 19     foreach ($array as $el) {
 20         if (iconv_strlen($el) > $max_l) {
 21             $max_l = iconv_strlen($el);
 22         }
 23     }
 24     return $max_l;
 25 }
 26
Б.3 Виведення поточного вмісту корзини до консолі
 27 function Show_basket()
 28 {
 29     global $basket;
 30     if (count($basket) == 0) {
 31         print "\nКОШИК ПОРОЖНІЙ\n";
 32         return;
 33     }
 34     $sorted = array_keys($basket);
 35     sort($sorted);
 36     $max_length = Get_length($sorted);
 37     print "У КОШИКУ:\n";
 38     print 'НАЗВА' . str_repeat(' ', $max_length - 5 + 2) . "КІЛЬКІСТЬ\n";
 39     foreach ($sorted as $product) {
 40         print $product . str_repeat(' ', $max_length - iconv_strlen($product) + 2)
 41         . $basket[$product] . "\n";
 42     }
 43 }
 44
Б.4 Додавання товару до кошику
 45 function Buy_product($ind)
 46 {
 47     global $products;
 48     global $basket;
 49     print "Вибрано: " . $products[$ind - 1] . "\n";
 50     $amount = readline('Введіть кількість, штук: ');
 51
 52     if (!is_numeric($amount) || floor($amount) != $amount) {
 53         print "ПОМИЛКА! Ви вказали неціле число\n";
 54         return;
 55     }
 56
 57     if ($amount === '0') {
 58         print 'ВИДАЛЯЮ ТОВАР З КОШИКА';
 59         if (array_key_exists($products[$ind - 1], $basket)) {
 60             unset($basket[$products[$ind - 1]]);
 61         }
 62     } else if ($amount < 1 || $amount > 99) {
 63         print "ПОМИЛКА! Ви вказали неправильну кількість товару (від 1 до 99)\n";
 64     } else {
 65         $basket[$products[$ind - 1]] = $amount;
 66     }
 67     Show_basket();
 68 }
 69
Б.5 Вибір товару з переліку та виклик функції Buy_product
 70 function Pick_product()
 71 {
 72     global $products;
 73     global $prices;
 74     $max_length = Get_length($products);
 75     while (true) {
 76         print "\n№  НАЗВА" . str_repeat(' ', $max_length - 5 + 2) . "ЦІНА\n";
 77         foreach ($products as $i => $product) {
 78             print ($i + 1) . '  '
 79             . $product . str_repeat(' ', $max_length - iconv_strlen($product) + 2)
 80             . $prices[$product] . "\n";
 81         }
 82         print "   -----------\n0  ПОВЕРНУТИСЯ\n";
 83         $choice = readline('Виберіть товар: ');
 84         if ($choice === '0') {
 85             return;
 86         }
 87         if ($choice < 1 || $choice > count($products)) {
 88             print "ПОМИЛКА! ВКАЗАНО НЕПРАВИЛЬНИЙ НОМЕР ТОВАРУ\n";
 89             continue;
 90         }
 91         Buy_product($choice);
 92     }
 93 }
 94
Б.6 Формування рахунку на основі обраних товарів
 95 function Get_bill()
 96 {
 97     global $products;
 98     global $prices;
 99     global $basket;
100     print "\n";
101     if (count($basket) == 0) {
102         print "КОШИК ПОРОЖНІЙ\n";
103         return;
104     }
105     $sorted = array_keys($basket);
106     sort($sorted);
107     $max_length_product = Get_length($products);
108     $max_length_price = max(Get_length($prices), iconv_strlen('ЦІНА'));
109     $max_length_amount = max(Get_length($basket), iconv_strlen('КІЛЬКІСТЬ'));
110     $sum = 0;
111     $i = 0;
112     print '№  НАЗВА' . str_repeat(' ', $max_length_product - 5 + 2)
113     . 'ЦІНА' . str_repeat(' ', $max_length_price - 4 + 2)
114     . 'КІЛЬКІСТЬ' . str_repeat(' ', $max_length_amount - 9 + 2) . "ВАРТІСТЬ\n";
115     foreach ($sorted as $product) {
116         $amount = $basket[$product];
117         print ++$i . '  ' . $product
118         . str_repeat(' ', $max_length_product - iconv_strlen($product) + 2)
119         . $prices[$product]
120         . str_repeat(' ', $max_length_price - iconv_strlen($prices[$product]) + 2)
121         . $amount . str_repeat(' ', $max_length_amount - iconv_strlen($amount) + 2)
122         . ($amount * $prices[$product]) . "\n";
123         $sum += $amount * $prices[$product];
124     }
125     print 'РАЗОМ ДО СПЛАТИ: ' . $sum . "\n";
126 }
127
Б.7 Редагування профіля користувача
128 function Change_profile()
129 {
130     print "\n";
131     $name = readline('Ваше ім?я: ');
132    while (!preg_match('/\p{L}/u', $name)) {
133     print "\nПОМИЛКА! В ІМЕНІ МАЄ БУТИ ХОЧА Б ОДНА ЛІТЕРА\n\n";
134     $name = readline('Ваше ім?я: ');
135 }
136     $age = readline('Ваш вік: ');
137     while ($age < 7 || $age > 150) {
138         print "ПОМИЛКА! НЕПРАВИЛЬНИЙ ВІК КОРИСТУВАЧА\n\n";
139         $age = readline('Ваш вік: ');
140     }
141     print "\nВаше ім?я: " . $name . "\nВаш вік: " . $age . "\n";
142 }
143
Б.4 Функція запуску головного меню магазину
144 function Run_menu()
145 {
146     while (true) {
147         print "\n1 Вибрати товари
148 2 Отримати підсумковий рахунок
149 3 Налаштувати свій профіль
150 0 Вийти з програми\n";
151         $option_selected = readline('Введіть команду: ');
152         switch ($option_selected) {
153         case '0':
154             print "\n";
155             return;
156         case 1:
157             Pick_product();
158             break;
159         case 2:
160             Get_bill();
161             break;
162         case 3:
163             Change_profile();
164             break;
165         default:
166             print 'ПОМИЛКА! Введіть правильну команду';
167             break;
168         }
169     }
170 }
171
172 print "\n################################
173 # ПРОДОВОЛЬЧИЙ МАГАЗИН \"ВЕСНА\" #
174 ################################\n";
175 Run_menu();
